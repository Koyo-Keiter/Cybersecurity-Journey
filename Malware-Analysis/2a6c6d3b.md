# Malware Analysis Report: 2a6c6d3bd8f0d37255de8ddd78ce0c686b45488ca274f1c7b1588512c0327742

## üõ°Ô∏è Lab Environment
* **Hypervisor:** Proxmox VE
* **Network:** Isolated Linux Bridge (`vmbr2`), No Physical Uplink.
* **Analysis VM:** REMnux (Gateway & Network Simulation)
* **Victim VM:** FLARE-VM (Windows 10 Analysis Build)

---

## üîç Phase 1: Static Analysis
*Initial triage performed to identify file signatures and potential capabilities.*

### File Identifiers
<img width="1533" height="755" alt="image" src="https://github.com/user-attachments/assets/63b47ad5-93c8-4759-b97a-9ed34c6567bd" />

**MD5:**
<img width="371" height="21" alt="image" src="https://github.com/user-attachments/assets/f80ffbd6-1e30-4ac3-b71b-4d5eb989fec0" />

**SHA-256:**
<img width="616" height="15" alt="image" src="https://github.com/user-attachments/assets/540078a7-0e5b-4a72-88ef-9e037b70f31b" />

Very Easily Identified via VirusTotal:
<img width="1841" height="885" alt="image" src="https://github.com/user-attachments/assets/81ede645-8e00-4ec1-9e23-7a5d6f959310" />

**Entropy:**
6.00964

**Portable Executable file confirmed by first bytes-text (MZ...)**

### Capability Mapping (Capa)
Using `capa`, the following MITRE ATT&CK techniques were identified:
* **Discovery:**
 `Application Windows Discovery [E1010]`
 `File and Directory Discovery [E1083]`
 `System Information Discovery [E1082]`

<img width="708" height="522" alt="image" src="https://github.com/user-attachments/assets/f5307722-46ed-4c73-99dc-2d243072dbda" />

Registry Key Editing: Persistence through shutdown and reboot cycles
Thread Creation: Disguises itself with other legitimate programs
### PE Analysis

PE revealed overriding of system with "SetProccessIsCritical" and "SetThreadExecutionState"
<img width="813" height="460" alt="image" src="https://github.com/user-attachments/assets/205f56bb-c45b-4a1e-9cdc-14ca1b9d64ee" />

Lack of many API calls and low readability show heavy packing
<img width="1532" height="743" alt="image" src="https://github.com/user-attachments/assets/7a55850e-569c-44f8-8060-587587b00a05" />
<img width="1539" height="749" alt="image" src="https://github.com/user-attachments/assets/e7adf8ca-3db2-4d5b-866e-b54541b3005b" />

**Static Deobfuscation**
Initial static deobfuscation attempts with `FLOSS` reveals key features:

<img width="848" height="215" alt="image" src="https://github.com/user-attachments/assets/e056b10a-c5fb-4283-aa43-a36adf070d90" />

VM Checker: Checking system information for common VM software
VPN Checker: Calls for ip address identifier to see approximate location
Security Bypass: "Add-MpPreference" line flags the directory to not be checked, "whitelisted", by Defender

---

## üß™ Phase 2: Dynamic Analysis
*Behavioral observations recorded during live execution.*

### Process Monitoring (ProcMon)
During execution, the malware initiated the following process tree:
1.  `2a6c6d3b.exe` was deleted by `MsMpEng.exe`.

<img width="761" height="184" alt="image" src="https://github.com/user-attachments/assets/29f0d345-8a8f-4725-a07a-555b02b3fa1b" />

3.  Modified registry almost 3 million times.

<img width="1529" height="744" alt="image" src="https://github.com/user-attachments/assets/72d3f702-9eca-4bf0-bc19-e41c2171ebfd" />

### Network Activity (Wireshark & Inetsim)
The sample attempted to communicate with external infrastructure:
* **DNS Queries:** `ip-api.com, ctdl.windowsupdate.com`

><img width="1524" height="754" alt="image" src="https://github.com/user-attachments/assets/2960448a-8dba-48c3-8845-346af21c5e11" />
<img width="1529" height="742" alt="image" src="https://github.com/user-attachments/assets/c83496a2-a000-431c-b595-8b8f6fd5d541" />

Malware seemingly checking for default websites to verify VM status
<img width="953" height="278" alt="image" src="https://github.com/user-attachments/assets/58ab4753-b940-4274-8c78-434c8fe306b5" />

### Host Changes (RegShot)
Comparison of the system state before and after execution:
* **Keys Added:** 
<img width="777" height="136" alt="image" src="https://github.com/user-attachments/assets/388c0269-3d3d-4e44-96af-21a7654122b1" />

* **Values Deleted:**
<img width="1103" height="111" alt="image" src="https://github.com/user-attachments/assets/b876fbc5-6007-4c13-a36d-27301dc36017" />

* **Values Added:**
<img width="1103" height="485" alt="image" src="https://github.com/user-attachments/assets/7675c827-0916-4312-b525-7a73d876378b" />

**No Files Added**

---

## üö© Indicators of Compromise (IOCs)
| Type | Value |
| :--- | :--- |
| **File Hash** | `2a6c6d3bd8f0d37255de8ddd78ce0c686b45488ca274f1c7b1588512c0327742` |
| **Domain** | `ip-api.com, ctdl.windowsupdate.com` |
| **IP Address** | `Never Connected` |
| **Registry** | `HKLM\SOFTWARE\Microsoft\Security Center\Svc\Vol, HKLM\SOFTWARE\Microsoft\Tracing\RASAPI32, HKLM\SOFTWARE\Microsoft\Tracing\RASMANCS, HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting\TermReason\7024` |

## üí° Conclusion
The sample appears to be a **Asynchronous Remote Access Trojan (Asynrat)** that focuses on **persistent surveilance**. The payload had built-in VM and VPN verifiers that seem to have been bypassed by Proxmox, but it wasn't able to connect to a C2 server (where the data flows) so it deleted itself.
